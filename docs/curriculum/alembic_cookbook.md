# üß≠ Alembic Cookbook: —à–∫–æ–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–π
> –°–º. –ø—Ä–∞–≤–∏–ª–∞ –æ—Ü–µ–Ω–∫–∏: [MODULE_ASSESSMENT.md](./MODULE_ASSESSMENT.md)


–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –≤–∞—à–∞ –ë–î ‚Äî —ç—Ç–æ –≥–æ—Ä–æ–¥, –∞ –º–∏–≥—Ä–∞—Ü–∏–∏ ‚Äî —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ —á–µ—Ä—Ç–µ–∂–∏. –†–∞–±–æ—Ç–∞–π—Ç–µ —Å –Ω–∏–º–∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ.

---

## üü¢ –ß–ê–°–¢–¨ 1. BASIC: –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏

### üß∞ –ú–æ–¥—É–ª—å AL1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```bash
pip install alembic psycopg2-binary  # –∏–ª–∏ asyncpg
alembic init alembic
```
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ sqlalchemy.url –≤ alembic.ini (–∏–ª–∏ –±–µ—Ä–∏—Ç–µ –∏–∑ env)
- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ target_metadata = Base.metadata

### üß™ –ú–æ–¥—É–ª—å AL2. –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
```bash
alembic revision --autogenerate -m "create users"
alembic upgrade head
alembic downgrade -1
```

### üïπ –ü—Ä–∞–∫—Ç–∏–∫–∞ (BASIC)
- –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ –∫ –º–æ–¥–µ–ª–∏ –∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ä–µ–≤–∏–∑–∏—é, –ø—Ä–∏–º–µ–Ω–∏—Ç–µ upgrade

### ‚úÖ –ß–µ–∫‚Äë–ª–∏—Å—Ç (BASIC)
- [ ] Alembic –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- [ ] target_metadata –ø–æ–¥–∫–ª—é—á—ë–Ω
- [ ] –†–µ–≤–∏–∑–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

---

## üîµ –ß–ê–°–¢–¨ 2. ADVANCED: –ë–æ–µ–≤—ã–µ –ø—Ä–∏—ë–º—ã

### üß± –ú–æ–¥—É–ª—å AL3. –†—É—á–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ —Ä–µ–≤–∏–∑–∏–π
- –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ –≤–∏–¥–∏—Ç –≤—Å—ë ‚Äî –ø—Ä–∞–≤—å—Ç–µ –≤—Ä—É—á–Ω—É—é (–∏–Ω–¥–µ–∫—Å—ã, –¥–µ—Ñ–æ–ª—Ç—ã, —Ç–∏–ø—ã)

### üß™ –ú–æ–¥—É–ª—å AL4. –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ CI
- –í –ø–∞–π–ø–ª–∞–π–Ω–µ: `alembic upgrade head` –ø–µ—Ä–µ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º/—Ç–µ—Å—Ç–∞–º–∏
- –î–ª—è async-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏–ª–∏ —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç

### üß® –ú–æ–¥—É–ª—å AL5. –û—Ç–∫–∞—Ç—ã –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- downgrade –¥–ª—è –≥–æ—Ä—è—á–∏—Ö —Ñ–∏–∫—Å–æ–≤
- feature‚Äë–≤–µ—Ç–∫–∏ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Ä–µ–≤–∏–∑–∏—è–º–∏

### üïπ –ü—Ä–∞–∫—Ç–∏–∫–∞ (ADVANCED)
- –ü–æ–¥–Ω–∏–º–∏—Ç–µ Postgres –≤ docker-compose, –ø—Ä–æ–≥–æ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –Ω—ë–º

### ‚úÖ –ß–µ–∫‚Äë–ª–∏—Å—Ç (ADVANCED)
- [ ] –†–µ–≤–∏–∑–∏–∏ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∏ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ
- [ ] CI –ø—Ä–æ–≥–æ–Ω—è–µ—Ç upgrade
- [ ] –û—Ç–∫–∞—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω


## –û—Ü–µ–Ω–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

- –ö–≤–∏–∑ (—Ç–µ–æ—Ä–∏—è)
  - –§–æ—Ä–º–∞—Ç: 10-20 –≤–æ–ø—Ä–æ—Å–æ–≤ (JSON/YAML/Markdown‚Äë–±–∞–Ω–∫).
  - –ü–æ—Ä–æ–≥ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: ‚â• 80% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.
- –ü—Ä–∞–∫—Ç–∏–∫–∞ (–∫–æ–¥/–∑–∞–¥–∞—á–∏)
  - –†–µ–ø–æ‚Äë–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è (–≤–Ω–æ—Å—è—Ç—Å—è –≤ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç).
  - –ü—Ä–æ–≤–µ—Ä–∫–∞: unit/integration/e2e —Ç–µ—Å—Ç–∞–º–∏.
- –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ (CI)
  - –§—Ä–æ–Ω—Ç: Vitest (+ –ø–æ–∫—Ä—ã—Ç–∏–µ), –ª–∏–Ω—Ç–µ—Ä—ã (ESLint/Prettier).
  - –ë—ç–∫: Pytest (httpx.AsyncClient), –ª–∏–Ω—Ç–µ—Ä—ã (ruff/flake8), –ø–æ–∫—Ä—ã—Ç–∏–µ.
  - E2E: Playwright (PW_BASE_URL).
- –†—É–±—Ä–∏–∫–∞
  - S (90‚Äì100): —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ, –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ, —Å—Ç–∏–ª—å —á–∏—Å—Ç—ã–π, –±–µ–∑ smell‚Äë–æ–≤.
  - A (80‚Äì89), B (70‚Äì79), C (<70) ‚Äî –ø–æ —É–±—ã–≤–∞–Ω–∏—é: –Ω–µ–¥–æ—á—ë—Ç—ã/–ø–æ–∫—Ä—ã—Ç–∏–µ/–ø–∞–¥–∞—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.
- Remediation
  - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–≤–∞–ª–æ–≤ (–∏–∑ –æ—Ç—á—ë—Ç–∞ CI) ‚Üí —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã —É—á–µ–±–Ω–∏–∫–∞.
