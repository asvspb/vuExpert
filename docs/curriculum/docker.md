# üê≥ Docker –≤–æ VueExpert: Dev/Preview –æ–∫—Ä—É–∂–µ–Ω–∏—è (–£—Ä–æ–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MASTER_PROMPT)

### –ö–æ–Ω—Ç–µ–∫—Å—Ç (–°—é–∂–µ—Ç)
–£ –∫–æ–º–∞–Ω–¥—ã ¬´—Ä–∞–±–æ—Ç–∞–µ—Ç —É –º–µ–Ω—è¬ª –∏ —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ù—É–∂–Ω–∞ –µ–¥–∏–Ω–∞—è dev/preview —Å—Ä–µ–¥–∞ –≤ Docker –±–µ–∑ –±–æ–ª–∏ —Å –ø–æ—Ä—Ç–∞–º–∏ –∏ HMR.

### 1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ó–∞–¥–∞–Ω–∏–µ (–¢–ó)
- –§–∞–π–ª—ã: `Dockerfile` (frontend), `docker-compose.yml`
- –ó–∞–¥–∞—á–∞: –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã `frontend` –∏ `backend`, –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—Ç—ã 5173 (dev) –∏ 4173 (preview), –∫–æ—Ä—Ä–µ—Ç–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å volume –¥–ª—è HMR, –¥–æ–±–∞–≤–∏—Ç—å healthchecks.
- –£—Å–ª–æ–≤–∏—è: frontend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Vite; preview –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è Playwright –≤ CI.

### 2. –†–µ—Ñ–µ—Ä–µ–Ω—Å (Visual/Logic Target)
- `docker compose up` –ø–æ–¥–Ω–∏–º–∞–µ—Ç —Ñ—Ä–æ–Ω—Ç (5173) –∏ –±—ç–∫ (8000)
- `npm run build && npm run preview` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–ª—É—à–∞–µ—Ç 4173

### 3. –¢–µ–æ—Ä–∏—è (Just-in-Time)
- –†–∞–∑–Ω–∏—Ü–∞ dev (HMR) vs preview (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞)
- –ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω `CHOKIDAR_USEPOLLING=1` –≤ Docker –¥–ª—è HMR –Ω–∞ Windows/Mac

### 4. –ü—Ä–∞–∫—Ç–∏–∫–∞ (Interactive Steps)
1) docker-compose.yml (—Ñ—Ä–∞–≥–º–µ–Ω—Ç)
```yaml
services:
  frontend:
    build: .
    command: npm run dev -- --host 0.0.0.0
    ports: ["5173:5173"]
    environment:
      - CHOKIDAR_USEPOLLING=1
    volumes:
      - ./:/app
      - /app/node_modules
  backend:
    build: ./backend
    ports: ["8000:8000"]
```
2) Preview: –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –Ω–∞ `npm run preview -- --host 0.0.0.0 --port 4173`, –ø–æ—Ä—Ç 4173
3) Healthcheck: –¥–æ–±–∞–≤–∏—Ç—å curl‚Äë–ø–∏–Ω–≥–∏ `/` –∏ `/docs` (–±—ç–∫)

### 5. –ß–µ–∫-–ª–∏—Å—Ç –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏ (Verification)
- [ ] HMR —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–∞–≤–∫–∏ .vue –≤–∏–¥–Ω—ã —Å—Ä–∞–∑—É)
- [ ] Preview –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ 4173
- [ ] Healthchecks –∑–µ–ª—ë–Ω—ã–µ

### 6. –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ (Troubleshooting)
- HMR –Ω–µ –ª–æ–≤–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Üí –¥–æ–±–∞–≤—å polling
- –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç ‚Üí –ø–æ–º–µ–Ω—è–π –º–∞–ø–ø–∏–Ω–≥ –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- Volume –ø–µ—Ä–µ—Ç–∏—Ä–∞–µ—Ç node_modules ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –∞–Ω–æ–Ω–∏–º–Ω—ã–π —Ç–æ–º –¥–ª—è node_modules

### 7. –†–µ—à–µ–Ω–∏–µ (Spoiler)
<details>
<summary>–ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–∞–ª–æ–Ω</summary>

```yaml
services:
  frontend:
    build: .
    working_dir: /app
    command: npm run dev -- --host 0.0.0.0
    ports: ["5173:5173"]
    environment:
      - CHOKIDAR_USEPOLLING=1
    volumes:
      - ./:/app
      - /app/node_modules
  backend:
    build: ./backend
    ports: ["8000:8000"]
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/docs"]
      interval: 10s
      timeout: 3s
      retries: 5
```
</details>

---

–í–æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–∞ –ø–æ **Docker** –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ **VueExpert**.
> –°–º. –ø—Ä–∞–≤–∏–ª–∞ –æ—Ü–µ–Ω–∫–∏: [MODULE_ASSESSMENT.md](./MODULE_ASSESSMENT.md)


–ù–∞—à–∞ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è: **¬´Docker ‚Äî —ç—Ç–æ –∫–æ–Ω–µ—Ü —ç–ø–æ—Ö–∏ "–ê —É –º–µ–Ω—è –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"¬ª**.
–ú—ã –Ω–µ —É—á–∏–º Docker –∫–∞–∫ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—É—é —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é –¥–ª—è –∞–¥–º–∏–Ω–æ–≤. –ú—ã —É—á–∏–º **Application Dockerization**: –∫–∞–∫ —É–ø–∞–∫–æ–≤–∞—Ç—å Vue –∏ FastAPI —Ç–∞–∫, —á—Ç–æ–±—ã –∏—Ö –º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫—Ç–æ —É–≥–æ–¥–Ω–æ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π, –∏ —á—Ç–æ–±—ã —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (Dev) –±—ã–ª–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω (Prod).

---

# üê≥ Docker –≤–æ VueExpert: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –î–µ–ø–ª–æ–π

–ö—É—Ä—Å —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏:
1.  **Basic:** –û—Å–Ω–æ–≤—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –Ω–∞–ø–∏—Å–∞–Ω–∏–µ Dockerfile, –º–∞–≥–∏—è Docker Compose –∏ –∑–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
2.  **Advanced:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤ (Multi-stage), –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —Å–µ—Ç–∏, Nginx –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ Production. **–ì–∞—Ä–∞–Ω—Ç —É—Ä–æ–≤–Ω—è Middle.**

---

## üü¢ –ß–ê–°–¢–¨ 1. BASIC: –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (Dev)

–†–µ–∂–∏–º—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:
- Dev: `npm run dev` (5173)
- Preview: `npm run build && npm run preview` (4173)
- –î–ª—è E2E —É–∫–∞–∂–∏—Ç–µ `PW_BASE_URL` –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (`http://localhost:4173`).

Healthcheck (–∫–∞–∫ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥):

–ü—Ä–∏–º–µ—Ä docker-compose:
```yaml
services:
  backend:
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 10s
      timeout: 3s
      retries: 5
      start_period: 5s
```

–í Dockerfile:
```Dockerfile
HEALTHCHECK --interval=30s --timeout=3s --retries=3 \
  CMD curl -f http://localhost:8000/health || exit 1
```

- –î–ª—è backend –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `HEALTHCHECK` –∏–ª–∏ —Å–µ–∫—Ü–∏—é `healthcheck:` –≤ Compose, –ø—Ä–æ–≤–µ—Ä—è—è `http://backend:8000/health`.

*–¶–µ–ª—å: –ó–∞–º–µ–Ω–∏—Ç—å —Ä—É—á–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É Python/Node.js –Ω–∞ `docker-compose up`. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Hot Reload.*

### üì¶ –ú–æ–¥—É–ª—å D1. –ö–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ –ò–∑–æ–ª—è—Ü–∏—è
**–ú–µ—Ç–∞—Ñ–æ—Ä–∞:** "–û–±—Ä–∞–∑ ‚Äî —ç—Ç–æ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω–∞—è –ø–∏—Ü—Ü–∞. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Äî —ç—Ç–æ –≥–æ—Ä—è—á–∞—è –ø–∏—Ü—Ü–∞ –≤ –ø–µ—á–∏".
*   **1.1. Image vs Container:**
    *   Read-only —Å–ª–æ–∏ –æ–±—Ä–∞–∑–∞.
    *   –ü–æ—á–µ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä "—É–º–∏—Ä–∞–µ—Ç" –∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç (ephemeral storage).
*   **1.2. Docker CLI:**
    *   `run`, `ps`, `stop`, `rm`.
    *   –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ `-p 8000:8000`. "–ü–æ—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞" vs "–ü–æ—Ä—Ç —Ö–æ—Å—Ç–∞".

### üêç –ú–æ–¥—É–ª—å D2. Dockerfile –¥–ª—è –ë—ç–∫–µ–Ω–¥–∞ (Python)
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –£–ø–∞–∫–æ–≤—ã–≤–∞–µ–º FastAPI.
*   **2.1. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:**
    *   `FROM python:3.12-slim` (–ø–æ—á–µ–º—É –Ω–µ full).
    *   `WORKDIR /app`.
    *   `COPY requirements.txt .` –∏ `RUN pip install`.
    *   `COPY . .`.
    *   `CMD ["uvicorn", "main:app", "--host", "0.0.0.0"]`.
*   **2.2. –°–ª–æ–µ–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Caching):**
    *   –ü–æ—á–µ–º—É –º—ã –∫–æ–ø–∏—Ä—É–µ–º `requirements.txt` *–¥–æ* –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å–±–æ—Ä–∫–∏.

### üñºÔ∏è –ú–æ–¥—É–ª—å D3. Dockerfile –¥–ª—è –§—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (Vue Dev)
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ó–∞–ø—É—Å–∫ Node.js —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
*   **3.1. Node Environment:**
    *   `FROM node:20`.
    *   `CMD ["npm", "run", "dev"]`.
*   **3.2. –ü—Ä–æ–±–ª–µ–º–∞ Host:**
    *   –ü–æ—á–µ–º—É Vite –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–ª—É—à–∞–µ—Ç `localhost` (–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞) –∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω —Å–Ω–∞—Ä—É–∂–∏.
    *   –§–ª–∞–≥ `--host 0.0.0.0`.

### üêô –ú–æ–¥—É–ª—å D4. Docker Compose (–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è)
**–ì–ª–∞–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.**
*   **4.1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `docker-compose.yml`:**
    *   Services (`backend`, `frontend`, `db`).
    *   Mapping Ports.
*   **4.2. Volumes (Hot Reload):**
    *   –°–∞–º–∞—è –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å –¥–ª—è Dev.
    *   `- ./backend:/app`: –°–≤—è–∑—ã–≤–∞–µ–º –ø–∞–ø–∫—É –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —Å –ø–∞–ø–∫–æ–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ. –ò–∑–º–µ–Ω–∏–ª –∫–æ–¥ -> —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª—Å—è.
*   **4.3. Networking:**
    *   –ú–∞–≥–∏—è DNS: –ü–æ—á–µ–º—É –±—ç–∫–µ–Ω–¥ –º–æ–∂–µ—Ç —Å—Ç—É—á–∞—Ç—å—Å—è –∫ –±–∞–∑–µ –ø–æ –∏–º–µ–Ω–∏ `db:5432` (–∞ –Ω–µ localhost).

### üîë –ú–æ–¥—É–ª—å D5. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
*   **5.1. Environment Variables:**
    *   –ö–∞–∫ –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å –æ—Ç –ë–î —á–µ—Ä–µ–∑ `.env` —Ñ–∞–π–ª.
    *   –†–∞–∑–¥–µ–ª `environment` –≤ Compose.
    *   –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ `.env` –≤ Git.

---

## üî¥ –ß–ê–°–¢–¨ 2. ADVANCED: Production Ready (Middle Grade)
*–¶–µ–ª—å: –°–¥–µ–ª–∞—Ç—å –æ–±—Ä–∞–∑—ã –ª–µ–≥–∫–∏–º–∏ (–º–∏–Ω—É—Å 500–ú–±), –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –∏ –±—ã—Å—Ç—Ä—ã–º–∏. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx.*

### üèóÔ∏è –ú–æ–¥—É–ª—å DA1. Multi-Stage Builds (–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)
**–ö–∏–ª–ª–µ—Ä-—Ñ–∏—á–∞ –¥–ª—è –§—Ä–æ–Ω—Ç–µ–Ω–¥–∞.**
*   **1.1. –ü—Ä–æ–±–ª–µ–º–∞:**
    *   –û–±—Ä–∞–∑ —Å Node.js –≤–µ—Å–∏—Ç 1–ì–±. –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ Node.js –Ω–∞–º –Ω–µ –Ω—É–∂–µ–Ω (Vue ‚Äî —ç—Ç–æ —Å—Ç–∞—Ç–∏–∫–∞).
*   **1.2. –†–µ—à–µ–Ω–∏–µ (Builder Pattern):**
    *   Stage 1 (Build): Node.js —Å–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç (`npm run build`) -> –ø–∞–ø–∫–∞ `dist`.
    *   Stage 2 (Run): Nginx (Alpine) –≤–µ—Å–æ–º 5–ú–±. –ö–æ–ø–∏—Ä—É–µ–º `dist` –≤ Nginx.
    *   *–†–µ–∑—É–ª—å—Ç–∞—Ç:* –û–±—Ä–∞–∑ –≤–µ—Å–∏—Ç 20–ú–± –≤–º–µ—Å—Ç–æ 1–ì–±.

### üõ°Ô∏è –ú–æ–¥—É–ª—å DA2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
*   **2.1. Non-root user:**
    *   –ü–æ—á–µ–º—É –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç `root` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –æ–ø–∞—Å–Ω–æ.
    *   –°–æ–∑–¥–∞–Ω–∏–µ —é–∑–µ—Ä–∞ `appuser` –≤ Dockerfile.
*   **2.2. .dockerignore:**
    *   –ö–∞–∫ –Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω–æ `venv`, `.git` –∏–ª–∏ `.env` –≤–Ω—É—Ç—Ä—å –æ–±—Ä–∞–∑–∞.

### üï∏Ô∏è –ú–æ–¥—É–ª—å DA3. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –°–µ—Ç–∏
*   **3.1. Bridge Networks:**
    *   –ò–∑–æ–ª—è—Ü–∏—è. –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–∏ `backend-net` (–±—ç–∫ + –±–∞–∑–∞) –∏ `frontend-net` (—Ñ—Ä–æ–Ω—Ç + –±—ç–∫). –ë–∞–∑–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é.
*   **3.2. Communication:**
    *   –ö–∞–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±—â–∞—é—Ç—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º (Docker DNS).
    *   –ü—Ä–æ–±–ª–µ–º–∞ "Loopback": –ü–æ—á–µ–º—É –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ–ª—å–∑—è –ø–æ—Å—Ç—É—á–∞—Ç—å—Å—è –Ω–∞ `localhost` —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—ã (–∏—Å–ø–æ–ª—å–∑—É–µ–º `host.docker.internal`).

### üíæ –ú–æ–¥—É–ª—å DA4. –î–∞–Ω–Ω—ã–µ –∏ –ë—ç–∫–∞–ø—ã
*   **4.1. Named Volumes vs Bind Mounts:**
    *   –†–∞–∑–Ω–∏—Ü–∞. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–º–∞ (–¥–ª—è –ë–î), –∞ –∫–æ–≥–¥–∞ –º–∞—É–Ω—Ç –ø–∞–ø–∫–∏ (–¥–ª—è –∫–æ–¥–∞).
*   **4.2. Database Persistence:**
    *   –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Postgres? (–î–∞–Ω–Ω—ã–µ –∂–∏–≤—ã –±–ª–∞–≥–æ–¥–∞—Ä—è Volume).
    *   –ö–æ–º–∞–Ω–¥–∞ `docker volume prune` (–û–ø–∞—Å–Ω–æ!).

### üö¶ –ú–æ–¥—É–ª—å DA5. Healthchecks –∏ Restart Policies
*   **5.1. –°–∞–º–æ–ª–µ—á–µ–Ω–∏–µ:**
    *   `restart: always` vs `on-failure`.
*   **5.2. Healthcheck:**
    *   –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `HEALTHCHECK CMD curl -f http://localhost:8000/health`.
    *   `depends_on` (condition: service_healthy): –ó–∞–ø—É—Å–∫–∞—Ç—å –±—ç–∫–µ–Ω–¥ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –±–∞–∑–∞ *–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ* –≥–æ—Ç–æ–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—å).

### üöÄ –ú–æ–¥—É–ª—å DA6. Production Server (Nginx Reverse Proxy)
**–§–∏–Ω–∞–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.**
*   **6.1. Reverse Proxy:**
    *   –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Nginx –ø–µ—Ä–µ–¥ FastAPI (SSL, —Å–∂–∞—Ç–∏–µ Gzip, —Å—Ç–∞—Ç–∏–∫–∞).
*   **6.2. Compose for Prod:**
    *   –û—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª `docker-compose.prod.yml`.
    *   –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ –ë–î –Ω–∞—Ä—É–∂—É (security).

### üèÜ –§–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫–∑–∞–º–µ–Ω Docker (Middle Project)
**–ó–∞–¥–∞–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–Ω—ã–π **CI/CD –ø–∞–π–ø–ª–∞–π–Ω** (–ª–æ–∫–∞–ª—å–Ω–æ –∏–º–∏—Ç–∏—Ä—É–µ–º).

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1.  **Frontend:** Multi-stage build (Node -> Nginx).
2.  **Backend:** Slim –æ–±—Ä–∞–∑, –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Gunicorn (–∞ –Ω–µ Uvicorn), non-root user.
3.  **Database:** Postgres —Å persistent volume.
4.  **Orchestration:** –°–∫—Ä–∏–ø—Ç `deploy.sh`, –∫–æ—Ç–æ—Ä—ã–π:
    *   –°–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑—ã.
    *   –ó–∞–ø—É—Å–∫–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ (`alembic upgrade head`) –≤–Ω—É—Ç—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
    *   –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã –±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞ (Rolling update –∏–º–∏—Ç–∞—Ü–∏—è).
5.  **Size Limit:** –û–±—Ä–∞–∑ –±—ç–∫–µ–Ω–¥–∞ < 200MB, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ < 30MB.

---

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏—à–∫–∏ –≤ –£—á–µ–±–Ω–∏–∫–µ

1.  **Layer Cake (–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ–µ–≤):**
    *   –°—Ç—É–¥–µ–Ω—Ç –ø–∏—à–µ—Ç Dockerfile.
    *   –°–ø—Ä–∞–≤–∞ —Ä–∏—Å—É–µ—Ç—Å—è "—Å–ª–æ–µ–Ω—ã–π —Ç–æ—Ä—Ç".
    *   –ï—Å–ª–∏ –æ–Ω –º–µ–Ω—è–µ—Ç –º–µ—Å—Ç–∞–º–∏ `COPY . .` –∏ `RUN pip install` ‚Äî —Ç–æ—Ä—Ç –ø–µ—Ä–µ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞—è, —á—Ç–æ –∫—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞ (–ø–ª–æ—Ö–æ).

2.  **Network Map:**
    *   –ì—Ä–∞—Ñ —Å —É–∑–ª–∞–º–∏ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏).
    *   –°—Ç—É–¥–µ–Ω—Ç —Ä–∏—Å—É–µ—Ç —Å–≤—è–∑–∏ –≤ `docker-compose.yml`.
    *   –ó–∞–¥–∞–Ω–∏–µ: "–°–¥–µ–ª–∞–π —Ç–∞–∫, —á—Ç–æ–±—ã –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ –º–æ–≥ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Redis –Ω–∞–ø—Ä—è–º—É—é".
    *   –°—Ç—É–¥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–∑–Ω–µ—Å—Ç–∏ –∏—Ö –ø–æ —Ä–∞–∑–Ω—ã–º —Å–µ—Ç—è–º.

3.  **The "It Works on My Machine" Button:**
    *   –°–∏–º—É–ª—è—Ç–æ—Ä. –°–ª–µ–≤–∞ "–ö–æ–º–ø—å—é—Ç–µ—Ä –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞" (Python 3.12, Windows). –°–ø—Ä–∞–≤–∞ "–°–µ—Ä–≤–µ—Ä" (Python 3.9, Linux).
    *   –ë–µ–∑ –î–æ–∫–µ—Ä–∞: –ö–æ–¥ –ø–∞–¥–∞–µ—Ç.
    *   –° –î–æ–∫–µ—Ä–æ–º: –ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ.

4.  **Volume Explorer:**
    *   –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –•–æ—Å—Ç–∞ –∏ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
    *   –°—Ç—É–¥–µ–Ω—Ç –ø–∏—à–µ—Ç —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É `/var/lib/postgresql/data` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
    *   –í–∏–¥–∏—Ç, –∫–∞–∫ —ç—Ç–æ—Ç —Ñ–∞–π–ª –º–∞–≥–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫–µ `pg_data` –Ω–∞ —Ö–æ—Å—Ç–µ.

## –û—Ü–µ–Ω–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

- –ö–≤–∏–∑ (—Ç–µ–æ—Ä–∏—è)
  - –§–æ—Ä–º–∞—Ç: 10-20 –≤–æ–ø—Ä–æ—Å–æ–≤ (JSON/YAML/Markdown‚Äë–±–∞–Ω–∫).
  - –ü–æ—Ä–æ–≥ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: ‚â• 80% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.
- –ü—Ä–∞–∫—Ç–∏–∫–∞ (–∫–æ–¥/–∑–∞–¥–∞—á–∏)
  - –†–µ–ø–æ‚Äë–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è (–≤–Ω–æ—Å—è—Ç—Å—è –≤ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç).
  - –ü—Ä–æ–≤–µ—Ä–∫–∞: unit/integration/e2e —Ç–µ—Å—Ç–∞–º–∏.
- –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ (CI)
  - –§—Ä–æ–Ω—Ç: Vitest (+ –ø–æ–∫—Ä—ã—Ç–∏–µ), –ª–∏–Ω—Ç–µ—Ä—ã (ESLint/Prettier).
  - –ë—ç–∫: Pytest (httpx.AsyncClient), –ª–∏–Ω—Ç–µ—Ä—ã (ruff/flake8), –ø–æ–∫—Ä—ã—Ç–∏–µ.
  - E2E: Playwright (PW_BASE_URL).
- –†—É–±—Ä–∏–∫–∞
  - S (90‚Äì100): —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ, –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ, —Å—Ç–∏–ª—å —á–∏—Å—Ç—ã–π, –±–µ–∑ smell‚Äë–æ–≤.
  - A (80‚Äì89), B (70‚Äì79), C (<70) ‚Äî –ø–æ —É–±—ã–≤–∞–Ω–∏—é: –Ω–µ–¥–æ—á—ë—Ç—ã/–ø–æ–∫—Ä—ã—Ç–∏–µ/–ø–∞–¥–∞—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.
- Remediation
  - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–≤–∞–ª–æ–≤ (–∏–∑ –æ—Ç—á—ë—Ç–∞ CI) ‚Üí —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã —É—á–µ–±–Ω–∏–∫–∞.
