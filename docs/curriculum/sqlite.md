# üóÑÔ∏è SQLite –≤–æ VueExpert: SQL –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI (–£—Ä–æ–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MASTER_PROMPT)

### –ö–æ–Ω—Ç–µ–∫—Å—Ç (–°—é–∂–µ—Ç)
–¢—ã –¥–æ–±–∞–≤–ª—è–µ—à—å —Ä–∞–∑–¥–µ–ª –∑–∞–∫–∞–∑–æ–≤. –ù—É–∂–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –∏ CRUD: –±–µ–∑ –¥—ã—Ä –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–æ–π. –ù–∞—á–Ω—ë–º –Ω–∞ SQLite –∫–∞–∫ –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –ø–æ–ª–∏–≥–æ–Ω–µ.

### 1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ó–∞–¥–∞–Ω–∏–µ (–¢–ó)
- Basic: —Ç–∞–±–ª–∏—Ü–∞ orders + CRUD –∏ —Ç–µ—Å—Ç
- Advanced: –∏–Ω–¥–µ–∫—Å—ã, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
- –§–∞–π–ª—ã: `backend/app/database.py`, `backend/app/models.py`
- –ó–∞–¥–∞—á–∞: –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `orders` –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π CRUD —á–µ—Ä–µ–∑ ORM/SQL —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏.
- –£—Å–ª–æ–≤–∏—è:
  - SQL: –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã; ORM: SQLAlchemy 2.0 Async
  - –¢–µ—Å—Ç: –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –µ—ë –æ–±—Ä–∞—Ç–Ω–æ

### 2. –†–µ—Ñ–µ—Ä–µ–Ω—Å (Visual/Logic Target)
```
orders(id PK, user_id, total_amount, created_at)
```

### 3. –¢–µ–æ—Ä–∏—è (Just-in-Time)
- Manifest typing SQLite, PK/FK, –ø–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Å–æ–±–∏—Ä–∞—Ç—å SQL-—Å—Ç—Ä–æ–∫–∏ –ø–ª—é—Å–∞–º–∏
- Async ORM vs sqlite3, –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞ PostgreSQL

### 4. –ü—Ä–∞–∫—Ç–∏–∫–∞ (Interactive Steps)
1) DDL (SQL)
```sql
CREATE TABLE IF NOT EXISTS orders (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  user_id INTEGER NOT NULL,
  total_amount REAL NOT NULL,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```
2) DML (Python, aiosqlite/ORM)
```py
# ___FILL_ORM_OR_SQL___: –≤—Å—Ç–∞–≤—å –∑–∞–ø–∏—Å—å –±–µ–∑–æ–ø–∞—Å–Ω–æ (param/ORM)
```
3) –¢–µ—Å—Ç
- –ù–∞–ø–∏—à–∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Å httpx.AsyncClient –∏–ª–∏ —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–º –º–æ–¥–µ–ª–∏

### 5. –ß–µ–∫-–ª–∏—Å—Ç –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏ (Verification)
- [ ] –ù–µ—Ç –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ SQL-—Å—Ç—Ä–æ–∫
- [ ] PK, NOT NULL, DEFAULT –≤–µ—Ä–Ω–æ –∑–∞–¥–∞–Ω—ã
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

### 6. –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ (Troubleshooting)
- Database locked ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π WAL –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –¢–∏–ø—ã/nullable ‚Üí –ø—Ä–æ–≤–µ—Ä—å —Å—Ö–µ–º—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é

### 7. –†–µ—à–µ–Ω–∏–µ (Spoiler)
<details>
<summary>–ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–∞–ª–æ–Ω</summary>

```py
# models.py (—Ñ—Ä–∞–≥–º–µ–Ω—Ç)
from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column
class Base(DeclarativeBase):
    pass
class Order(Base):
    __tablename__ = 'orders'
    id: Mapped[int] = mapped_column(primary_key=True, autoincrement=True)
    user_id: Mapped[int]
    total_amount: Mapped[float]
    created_at: Mapped[str] = mapped_column(server_default=text('CURRENT_TIMESTAMP'))

# database.py (DDL init)
async with engine.begin() as conn:
    await conn.run_sync(Base.metadata.create_all)

# —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
async with async_session() as s:
    async with s.begin():
        s.add(Order(user_id=1, total_amount=1299.0))

# —á—Ç–µ–Ω–∏–µ
async with async_session() as s:
    row = await s.scalar(select(Order).order_by(Order.id.desc()))
```
</details>

---

–í–æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–∞ –ø–æ **SQLite** –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ **VueExpert**.
> –°–º. –ø—Ä–∞–≤–∏–ª–∞ –æ—Ü–µ–Ω–∫–∏: [MODULE_ASSESSMENT.md](./MODULE_ASSESSMENT.md)


–í –º–∏—Ä–µ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ SQLite —á–∞—Å—Ç–æ –Ω–µ–¥–æ–æ—Ü–µ–Ω–∏–≤–∞—é—Ç (¬´—ç—Ç–æ –∏–≥—Ä—É—à–µ—á–Ω–∞—è –±–∞–∑–∞¬ª). –ú—ã –ø–µ—Ä–µ–≤–µ—Ä–Ω–µ–º —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.
–ù–∞—à–∞ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è: **¬´SQLite ‚Äî —ç—Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–π –ø–æ–ª–∏–≥–æ–Ω –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è SQL –∏ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Ç–µ–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –∂–∏–≤–µ—Ç –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ¬ª**.

–ú—ã –±—É–¥–µ–º —É—á–∏—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–∞–∫, —á—Ç–æ–±—ã –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ PostgreSQL –≤ –±—É–¥—É—â–µ–º —Ç—Ä–µ–±–æ–≤–∞–ª —Å–º–µ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `DATABASE_URL` (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ `SQLITE_PATH`) –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ `asyncpg`.

---

# üóÑÔ∏è SQLite –≤–æ VueExpert: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞—Ä–º–∞–Ω–µ

–ö—É—Ä—Å —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏:
1.  **Basic:** –Ø–∑—ã–∫ SQL, —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è —Ç–µ–æ—Ä–∏—è, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è. –£—á–∏–º—Å—è "–¥—É–º–∞—Ç—å —Ç–∞–±–ª–∏—Ü–∞–º–∏".
2.  **Advanced:** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (`aiosqlite`), ORM (SQLAlchemy), –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è. **–ì–∞—Ä–∞–Ω—Ç —É—Ä–æ–≤–Ω—è Middle.**

---

## üü¢ –ß–ê–°–¢–¨ 1. BASIC: SQL –∏ –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞
*–¶–µ–ª—å: –ü–æ–Ω—è—Ç—å, –∫–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏ –≤—ã—É—á–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã (CRUD).*

### üì¶ –ú–æ–¥—É–ª—å S1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
**–ú–µ—Ç–∞—Ñ–æ—Ä–∞:** "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ —É–º–Ω–∞—è Excel-—Ç–∞–±–ª–∏—Ü–∞".
*   **1.1. Serverless Nature:**
    *   –ü–æ—á–µ–º—É –Ω–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä. –§–∞–π–ª `.db` = –≤—Å—è –±–∞–∑–∞.
    *   –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: **DB Browser for SQLite** (GUI) –∏ –ø–ª–∞–≥–∏–Ω—ã VS Code.
*   **1.2. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (Manifest Typing):**
    *   `INTEGER`, `TEXT`, `REAL`, `BLOB`, `NULL`.
    *   –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å SQLite: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è (–º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å —Ç–µ–∫—Å—Ç –≤ —á–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ, –Ω–æ –º—ã –Ω–∞—É—á–∏–º —Ç–∞–∫ –Ω–µ –¥–µ–ª–∞—Ç—å).

### üìê –ú–æ–¥—É–ª—å S2. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã (DDL)
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞.
*   **2.1. –¢–∞–±–ª–∏—Ü—ã –∏ –ö–ª—é—á–∏:**
    *   `CREATE TABLE`.
    *   **Primary Key (PK):** –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ç–æ–≤–∞—Ä–∞. `AUTOINCREMENT`.
*   **2.2. –°–≤—è–∑–∏ (Relationships):**
    *   **Foreign Key (FK):** –ö–∞–∫ —Å–≤—è–∑–∞—Ç—å `orders` —Å `users`.
    *   –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (Constraints): `NOT NULL`, `UNIQUE` (email –Ω–µ –º–æ–∂–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è), `DEFAULT`.
*   **2.3. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–ù–∞ –ø–∞–ª—å—Ü–∞—Ö):**
    *   –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é. –ü–µ—Ä–≤–∞—è, –≤—Ç–æ—Ä–∞—è –∏ —Ç—Ä–µ—Ç—å—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã.

### üîç –ú–æ–¥—É–ª—å S3. –Ø–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ (DML / CRUD)
**–°—Ä–µ–¥–∞:** –ü–∏—à–µ–º Raw SQL –≤ –∫–æ–Ω—Å–æ–ª–∏ –∏–ª–∏ GUI.
*   **3.1. INSERT (–°–æ–∑–¥–∞–Ω–∏–µ):**
    *   –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ø–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Å–æ–±–∏—Ä–∞—Ç—å SQL-—Å—Ç—Ä–æ–∫—É –ø–ª—é—Å–∏–∫–∞–º–∏).
*   **3.2. SELECT (–ß—Ç–µ–Ω–∏–µ):**
    *   `WHERE`: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (—Ü–µ–Ω–∞ > 1000).
    *   `ORDER BY`: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞.
    *   `LIMIT / OFFSET`: –ü–∞–≥–∏–Ω–∞—Ü–∏—è (—Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤).
*   **3.3. UPDATE –∏ DELETE:**
    *   –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É –∏ –Ω–µ –æ–±–Ω—É–ª–∏—Ç—å –≤—Å—é —Ç–∞–±–ª–∏—Ü—É (–∑–∞–±—ã—Ç—ã–π `WHERE`).
*   **3.4. –ê–≥—Ä–µ–≥–∞—Ü–∏—è:**
    *   `COUNT`, `SUM`, `AVG`. –°–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –≤ –∫–æ—Ä–∑–∏–Ω–µ?

### üîó –ú–æ–¥—É–ª—å S4. JOINs (–ú–∞–≥–∏—è —Å–≤—è–∑–µ–π)
*   **4.1. INNER JOIN:**
    *   "–ü–æ–∫–∞–∂–∏ –º–Ω–µ –∑–∞–∫–∞–∑—ã –ò –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∏—Ö —Å–¥–µ–ª–∞–ª–∏".
*   **4.2. LEFT JOIN:**
    *   "–ü–æ–∫–∞–∂–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –¥–∞–∂–µ –µ—Å–ª–∏ —É –Ω–∏—Ö –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤".
*   **4.3. –ü—Ä–æ–±–ª–µ–º–∞ N+1 (–¢–µ–æ—Ä–∏—è):**
    *   –ü–æ—á–µ–º—É –¥–µ–ª–∞—Ç—å 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Ü–∏–∫–ª–µ ‚Äî –ø–ª–æ—Ö–æ, –∞ –æ–¥–∏–Ω JOIN ‚Äî —Ö–æ—Ä–æ—à–æ.

---

## üî¥ –ß–ê–°–¢–¨ 2. ADVANCED: Python Integration & ORM (Middle Grade)
*–¶–µ–ª—å: –í—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑—É –≤ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Å–¥–µ–ª–∞—Ç—å –µ—ë –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–æ—á–≤—É –¥–ª—è PostgreSQL.*

### üêç –ú–æ–¥—É–ª—å SA1. Python `sqlite3` (Low Level)
*–ó–∞—á–µ–º:* –ß—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –¥—Ä–∞–π–≤–µ—Ä—ã –ë–î "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º".
*   **1.1. Connection & Cursor:**
    *   –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–∞—Ç—Ç–µ—Ä–Ω `with conn:`.
*   **1.2. SQL Injection (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å):**
    *   –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (`?` –∏–ª–∏ `:value`).
    *   *–ü—Ä–∞–∫—Ç–∏–∫–∞:* –ù–∞–ø–∏—Å–∞—Ç—å –¥—ã—Ä—è–≤—ã–π –∫–æ–¥, "–≤–∑–ª–æ–º–∞—Ç—å" –µ–≥–æ —á–µ—Ä–µ–∑ –≤–≤–æ–¥ `'; DROP TABLE users; --` –∏ –ø–æ—á–∏–Ω–∏—Ç—å.
*   **1.3. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (ACID):**
    *   `commit()` –∏ `rollback()`.
    *   –ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å: –õ–∏–±–æ –¥–µ–Ω—å–≥–∏ —Å–ø–∏—Å–∞–ª–∏—Å—å –ò —Ç–æ–≤–∞—Ä –¥–æ–±–∞–≤–∏–ª—Å—è, –ª–∏–±–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ.

### ‚ö°Ô∏è –ú–æ–¥—É–ª—å SA2. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å (`aiosqlite`)
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** FastAPI ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π, –∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `sqlite3` ‚Äî –±–ª–æ–∫–∏—Ä—É—é—â–∏–π.
*   **2.1. –ü—Ä–æ–±–ª–µ–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:**
    *   –ü–æ—á–µ–º—É –æ–±—ã—á–Ω—ã–π SQL-–∑–∞–ø—Ä–æ—Å —Å—Ç–∞–≤–∏—Ç –≤–µ—Å—å —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–∞—É–∑—É.
*   **2.2. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `aiosqlite`:**
    *   `async with aiosqlite.connect(...)`.
    *   –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫—É—Ä—Å–æ—Ä—ã.

### üèóÔ∏è –ú–æ–¥—É–ª—å SA3. SQLAlchemy 2.0 (Async ORM)
**–ì–ª–∞–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç–∞.**
*   **3.1. Declarative Models:**
    *   –û–ø–∏—Å—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã –∫–∞–∫ Python-–∫–ª–∞—Å—Å—ã (`class User(Base)`).
    *   `Mapped[int]`, `mapped_column`.
*   **3.2. Async Engine & Session:**
    *   –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `create_async_engine`.
    *   Dependency Injection —Å–µ—Å—Å–∏–∏ –≤ FastAPI.
*   **3.3. Alembic (–ú–∏–≥—Ä–∞—Ü–∏–∏):**
    *   –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª `.db` –∏ —Å–æ–∑–¥–∞—Ç—å –∑–∞–Ω–æ–≤–æ.
    *   –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î. –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–π.

### üöÄ –ú–æ–¥—É–ª—å SA4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å
*   **4.1. –ò–Ω–¥–µ–∫—Å—ã (Indexes):**
    *   –ö–∞–∫ —É—Å–∫–æ—Ä–∏—Ç—å –ø–æ–∏—Å–∫ –ø–æ `email` –≤ 1000 —Ä–∞–∑. `CREATE INDEX`.
    *   `EXPLAIN QUERY PLAN` ‚Äî —Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –±–∞–∑–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å.
*   **4.2. WAL Mode (Write-Ahead Logging):**
    *   –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –Ω—é–∞–Ω—Å SQLite. –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —á–∏—Ç–∞—Ç—å –∏ –ø–∏—Å–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–¥–ª—è High Load –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞).
*   **4.3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è SQLite:**
    *   –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–æ–≥–∏—Ö —Ç–∏–ø–æ–≤ (Check Constraints).
    *   –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å—å—é (Database Locked).
    *   *–í—ã–≤–æ–¥:* –ö–æ–≥–¥–∞ –ø–æ—Ä–∞ –ø–µ—Ä–µ–µ–∑–∂–∞—Ç—å –Ω–∞ PostgreSQL.

### üèÜ –§–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫–∑–∞–º–µ–Ω SQLite (Middle Project)
**–ó–∞–¥–∞–Ω–∏–µ:** –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–æ–π –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–∏—Å—Ç–µ–º—ã "–°–∫–ª–∞–¥".

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1.  **–°—Ö–µ–º–∞:** –¢–∞–±–ª–∏—Ü—ã `Products`, `Categories`, `Warehouses`. –°–≤—è–∑–∏ Many-to-Many (–¢–æ–≤–∞—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–∫–ª–∞–¥–∞—Ö).
2.  **ORM:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQLAlchemy Async.
3.  **–ú–∏–≥—Ä–∞—Ü–∏–∏:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Alembic. –°–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é (init) –∏ –≤—Ç–æ—Ä—É—é (–¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É `stock_quantity`).
4.  **–°–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å:** –ù–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å (—á–µ—Ä–µ–∑ ORM), –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç–∞–µ—Ç –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —Å–∫–ª–∞–¥–µ.
5.  **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –ø–æ–ª—è, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –∏–¥–µ—Ç –ø–æ–∏—Å–∫.

---

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏—à–∫–∏ –≤ –£—á–µ–±–Ω–∏–∫–µ

1.  **SQL Visualizer (Visual JOINs):**
    *   –î–≤–∞ –∫—Ä—É–≥–∞ (–ú–Ω–æ–∂–µ—Å—Ç–≤–∞ –í–µ–Ω–Ω–∞).
    *   –°—Ç—É–¥–µ–Ω—Ç –ø–∏—à–µ—Ç `INNER JOIN`. –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –∫—Ä—É–≥–æ–≤ –∑–∞–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è.
    *   –°—Ç—É–¥–µ–Ω—Ç –ø–∏—à–µ—Ç `LEFT JOIN`. –ó–∞–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ª–µ–≤—ã–π –∫—Ä—É–≥ —Ü–µ–ª–∏–∫–æ–º.
    *   –≠—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è.

2.  **"SQL Injection" Sandbox:**
    *   –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ "Login".
    *   –ó–∞–¥–∞—á–∞: –í–æ–π—Ç–∏ –∫–∞–∫ Admin, –Ω–µ –∑–Ω–∞—è –ø–∞—Ä–æ–ª—è.
    *   –†–µ—à–µ–Ω–∏–µ: –í–≤–µ—Å—Ç–∏ `admin' --`.
    *   –£—á–µ–±–Ω–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ SQL-–∑–∞–ø—Ä–æ—Å –∏–∑–º–µ–Ω–∏–ª—Å—è –∏ –ø–æ—á–µ–º—É –ø–∞—Ä–æ–ª—å –±—ã–ª –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω.

3.  **Migration Time Machine:**
    *   –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã (–∫–æ–ª–æ–Ω–∫–∏).
    *   –ö–Ω–æ–ø–∫–∞ "Apply Migration": –¢–∞–±–ª–∏—Ü–∞ –º–µ–Ω—è–µ—Ç—Å—è.
    *   –ö–Ω–æ–ø–∫–∞ "Downgrade": –¢–∞–±–ª–∏—Ü–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞–∑–∞–¥.
    *   –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã Alembic.

## –û—Ü–µ–Ω–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

- –ö–≤–∏–∑ (—Ç–µ–æ—Ä–∏—è)
  - –§–æ—Ä–º–∞—Ç: 10-20 –≤–æ–ø—Ä–æ—Å–æ–≤ (JSON/YAML/Markdown‚Äë–±–∞–Ω–∫).
  - –ü–æ—Ä–æ–≥ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: ‚â• 80% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.
- –ü—Ä–∞–∫—Ç–∏–∫–∞ (–∫–æ–¥/–∑–∞–¥–∞—á–∏)
  - –†–µ–ø–æ‚Äë–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è (–≤–Ω–æ—Å—è—Ç—Å—è –≤ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç).
  - –ü—Ä–æ–≤–µ—Ä–∫–∞: unit/integration/e2e —Ç–µ—Å—Ç–∞–º–∏.
- –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ (CI)
  - –§—Ä–æ–Ω—Ç: Vitest (+ –ø–æ–∫—Ä—ã—Ç–∏–µ), –ª–∏–Ω—Ç–µ—Ä—ã (ESLint/Prettier).
  - –ë—ç–∫: Pytest (httpx.AsyncClient), –ª–∏–Ω—Ç–µ—Ä—ã (ruff/flake8), –ø–æ–∫—Ä—ã—Ç–∏–µ.
  - E2E: Playwright (PW_BASE_URL).
- –†—É–±—Ä–∏–∫–∞
  - S (90‚Äì100): —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ, –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ, —Å—Ç–∏–ª—å —á–∏—Å—Ç—ã–π, –±–µ–∑ smell‚Äë–æ–≤.
  - A (80‚Äì89), B (70‚Äì79), C (<70) ‚Äî –ø–æ —É–±—ã–≤–∞–Ω–∏—é: –Ω–µ–¥–æ—á—ë—Ç—ã/–ø–æ–∫—Ä—ã—Ç–∏–µ/–ø–∞–¥–∞—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.
- Remediation
  - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–≤–∞–ª–æ–≤ (–∏–∑ –æ—Ç—á—ë—Ç–∞ CI) ‚Üí —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã —É—á–µ–±–Ω–∏–∫–∞.
