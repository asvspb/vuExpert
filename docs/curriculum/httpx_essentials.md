# üåê httpx essentials: –±—ã—Å—Ç—Ä—ã–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ HTTP (–£—Ä–æ–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MASTER_PROMPT)

### –ö–æ–Ω—Ç–µ–∫—Å—Ç (–°—é–∂–µ—Ç)
–ù—É–∂–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ –±–∏—Ç—å –≤–Ω–µ—à–Ω–∏–π API: —Ç–∞–π–º–∞—É—Ç—ã, —Ä–µ—Ç—Ä–∞–∏ –∏ –±—ã—Å—Ç—Ä—ã–µ in‚Äëprocess —Ç–µ—Å—Ç—ã –±–µ–∑ —Å–µ—Ç–∏.

### 1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ó–∞–¥–∞–Ω–∏–µ (–¢–ó)
- Basic: AsyncClient helper —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏, in-process —Ç–µ—Å—Ç—ã
- Advanced: —Ä–µ—Ç—Ä–∞–∏/–±—ç–∫–æ—Ñ—Ñ –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏, negative-—Ç–µ—Å—Ç—ã –Ω–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- –§–∞–π–ª—ã: `backend/app/clients/http.py`, `backend/tests/test_http.py`
- –ó–∞–¥–∞—á–∞: —Å–¥–µ–ª–∞—Ç—å AsyncClient helper —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏ –∏ —Ä–µ—Ç—Ä–∞—è–º–∏; –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã —Å in‚Äëprocess –∫–ª–∏–µ–Ω—Ç–æ–º (`app=app, base_url="http://test"`).
- –£—Å–ª–æ–≤–∏—è: —è–≤–Ω—ã–π Timeout, 3 —Ä–µ—Ç—Ä–∞—è –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏.

### 2. –†–µ—Ñ–µ—Ä–µ–Ω—Å (Visual/Logic Target)
- Helper –±—Ä–æ—Å–∞–µ—Ç –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ —Ä–µ—Ç—Ä–∞–µ–≤
- In‚Äëprocess —Ç–µ—Å—Ç—ã –±—ã—Å—Ç—Ä—ã–µ

### 3. –¢–µ–æ—Ä–∏—è (Just-in-Time)
- Timeout/Retry/Backoff
- In‚Äëprocess vs —Ä–µ–∞–ª—å–Ω–∞—è —Å–µ—Ç—å

### 4. –ü—Ä–∞–∫—Ç–∏–∫–∞ (Interactive Steps)
–§—Ä–∞–≥–º–µ–Ω—Ç—ã –∫ –¥–æ—Ä–∞–±–æ—Ç–∫–µ:
```python
async with httpx.AsyncClient(base_url=BASE, timeout=httpx.Timeout(5.0)) as client:
    # ___FILL___: —Ä–µ—Ç—Ä–∞–∏ –Ω–∞ 5xx –∏ timeouts
```
```python
async with httpx.AsyncClient(app=app, base_url="http://test") as client:
    r = await client.get("/items")
```

### 5. –ß–µ–∫-–ª–∏—Å—Ç –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏ (Verification)
- [ ] –Ø–≤–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã
- [ ] –†–µ—Ç—Ä–∞–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- [ ] In‚Äëprocess —Ç–µ—Å—Ç—ã –±–µ–∑ —Å–µ—Ç–∏

### 6. –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ (Troubleshooting)
- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ä–µ—Ç—Ä–∞–∏ ‚Üí –¥–æ–±–∞–≤—å –ª–∏–º–∏—Ç/–±—ç–∫–æ—Ñ—Ñ
- –ü—Ä–æ–≥–ª–∞—Ç—ã–≤–∞–µ—à—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è ‚Üí –ø–æ–∫—Ä—ã–≤–∞–π —Ç–µ—Å—Ç–æ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã

### 7. –†–µ—à–µ–Ω–∏–µ (Spoiler)
<details>
<summary>–ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–∞–ª–æ–Ω</summary>

```python
import asyncio, httpx

async def get_with_retry(client, url, retries=3):
    for attempt in range(retries):
        try:
            r = await client.get(url)
            r.raise_for_status()
            return r
        except (httpx.ConnectError, httpx.ReadTimeout, httpx.HTTPStatusError) as e:
            if attempt == retries - 1:
                raise
            await asyncio.sleep(0.2 * (attempt + 1))
```
</details>

---
> –°–º. –ø—Ä–∞–≤–∏–ª–∞ –æ—Ü–µ–Ω–∫–∏: [MODULE_ASSESSMENT.md](./MODULE_ASSESSMENT.md)


–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –≤–∞—à –∫–ª–∏–µ–Ω—Ç ‚Äî —Ä–∞–∑–≤–µ–¥—á–∏–∫. –û–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±—ã—Å—Ç—Ä—ã–º, —Ç–∏—Ö–∏–º –∏ —É–º–µ—Ç—å –æ—Ç—Å—Ç—É–ø–∞—Ç—å –ø—Ä–∏ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ç–∞–π–º–∞—É—Ç—ã/—Ä–µ—Ç—Ä–∞–∏).

---

## üü¢ –ß–ê–°–¢–¨ 1. BASIC: –†–∞–∑–≤–µ–¥–∫–∞

### üö∂ –ú–æ–¥—É–ª—å HX1. –ü–µ—Ä–≤–∞—è –≤—ã–ª–∞–∑–∫–∞
```python
import httpx
async with httpx.AsyncClient(base_url="http://localhost:8000", timeout=10.0) as client:
    r = await client.get("/health")
    r.raise_for_status()
```

### ‚è± –ú–æ–¥—É–ª—å HX2. –¢–∞–π–º–∞—É—Ç—ã
```python
import httpx
async with httpx.AsyncClient(timeout=httpx.Timeout(5.0)) as client:
    r = await client.get("/counter")
```

### üïπ –ü—Ä–∞–∫—Ç–∏–∫–∞ (BASIC)
- –ü–æ–ª—É—á–∏—Ç–µ /health, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å 200 –∏ –ø–æ–ª—è JSON

### ‚úÖ –ß–µ–∫‚Äë–ª–∏—Å—Ç (BASIC)
- [ ] AsyncClient
- [ ] –Ø–≤–Ω—ã–π timeout

---

## üîµ –ß–ê–°–¢–¨ 2. ADVANCED: –í—ã–∂–∏–≤–∞–Ω–∏–µ

### üîÅ –ú–æ–¥—É–ª—å HX3. –†–µ—Ç—Ä–∞–∏ (—Ä—É—á–Ω–æ–π)
```python
for _ in range(3):
  try:
    return await client.get("/counter")
  except httpx.HTTPError:
    await asyncio.sleep(0.2)
```

### üß™ –ú–æ–¥—É–ª—å HX4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞
```python
async with httpx.AsyncClient(app=app, base_url="http://test") as client:
    r = await client.get("/items")
```

### üïπ –ü—Ä–∞–∫—Ç–∏–∫–∞ (ADVANCED)
- –ù–∞–ø–∏—à–∏—Ç–µ helper —Å —Ä–µ—Ç—Ä–∞—è–º–∏ –∏ —Ç–µ—Å—Ç –Ω–∞ –Ω–µ–≥–æ

### ‚úÖ –ß–µ–∫‚Äë–ª–∏—Å—Ç (ADVANCED)
- [ ] –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- [ ] In‚Äëprocess —Ç–µ—Å—Ç—ã –±—ã—Å—Ç—Ä—ã–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ


## –û—Ü–µ–Ω–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

- –ö–≤–∏–∑ (—Ç–µ–æ—Ä–∏—è)
  - –§–æ—Ä–º–∞—Ç: 10-20 –≤–æ–ø—Ä–æ—Å–æ–≤ (JSON/YAML/Markdown‚Äë–±–∞–Ω–∫).
  - –ü–æ—Ä–æ–≥ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: ‚â• 80% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.
- –ü—Ä–∞–∫—Ç–∏–∫–∞ (–∫–æ–¥/–∑–∞–¥–∞—á–∏)
  - –†–µ–ø–æ‚Äë–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è (–≤–Ω–æ—Å—è—Ç—Å—è –≤ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç).
  - –ü—Ä–æ–≤–µ—Ä–∫–∞: unit/integration/e2e —Ç–µ—Å—Ç–∞–º–∏.
- –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ (CI)
  - –§—Ä–æ–Ω—Ç: Vitest (+ –ø–æ–∫—Ä—ã—Ç–∏–µ), –ª–∏–Ω—Ç–µ—Ä—ã (ESLint/Prettier).
  - –ë—ç–∫: Pytest (httpx.AsyncClient), –ª–∏–Ω—Ç–µ—Ä—ã (ruff/flake8), –ø–æ–∫—Ä—ã—Ç–∏–µ.
  - E2E: Playwright (PW_BASE_URL).
- –†—É–±—Ä–∏–∫–∞
  - S (90‚Äì100): —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ, –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ, —Å—Ç–∏–ª—å —á–∏—Å—Ç—ã–π, –±–µ–∑ smell‚Äë–æ–≤.
  - A (80‚Äì89), B (70‚Äì79), C (<70) ‚Äî –ø–æ —É–±—ã–≤–∞–Ω–∏—é: –Ω–µ–¥–æ—á—ë—Ç—ã/–ø–æ–∫—Ä—ã—Ç–∏–µ/–ø–∞–¥–∞—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.
- Remediation
  - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–≤–∞–ª–æ–≤ (–∏–∑ –æ—Ç—á—ë—Ç–∞ CI) ‚Üí —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã —É—á–µ–±–Ω–∏–∫–∞.
